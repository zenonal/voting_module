<div>
	<h3> <%= t(:comment_title) %></h3>
	<% form_for [@commentable, Comment.new] do |f| %>
			<p>
				<%= f.label t(:new_comment) %><br>
				<%= f.text_area :content, :class => "comment_field" %>
			</p>
			<p><%= f.submit t(:submit_str) %></p>
	<% end %>
	<% for comment in @commentable.comments.current_lg(I18n.locale) %>
	
	<table>
		<tr>
			<td>
	    		<div class = "comment">
					<table>
						<tr>
							<div class = "comment_header">
								<td><h3><%= User.find_by_id(comment.user_id).displayName %>, <em><%= comment.created_at.strftime("%e %B, %Y") %></em></h3></td>
							</div>
						</tr>
					</table>
			
					<div class = "comment_content">
						<%= simple_format comment.content %>
						<% unless current_user.nil? %>
							<% if (comment.user_id == current_user.id) | permitted_to?(:delete, comment) %>
								<span style="float:right;"><%= link_to t(:delete_str), polymorphic_path([@commentable,comment]), :confirm => t(:are_you_sure_str), :method => :delete, :class => "button" %></span>
							<% end %>
						<% end %>
						<% if permitted_to? :create, Comment.new %>
							<%= link_to t(:reply_to_comment_str), :controller => :comments, :action => :reply_to_comment, :id => comment.id, :current_url => request.request_uri, :class => "link" %>
						<% end %>
		
						<p><%= button_to t(:com_exclude_str), {:controller => :comments, :action => :exclude_comment, :id => comment.id}, :title => t(:com_exclude_str) %></p>
						<% if comment.exclusion_requests > 0 %>
							<p style="font-size:9px">! <%= t(:exclusion_requests_str) %>
							<% comment.exclusions.each do |l| %>
							<span style="color:#F00">X</span></p>
							<%end %>
						<% end %>
					</div>
			
</div>

	<%= render :partial => 'layouts/replies', :collection => comment.replies, :as => :reply %>
	
	
		</td>
		</tr>
		</table>
	
	
	<% end %>
	
	
</div>
